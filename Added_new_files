import pandas as pd
import os
from sqlalchemy import create_engine

user = ""
password = ""
host = "localhost"
database = "AIRBNB"

engine = create_engine(f"mysql+pymysql://{user}:{password}@{host}/{database}")

folder_path = "/Users/m------/Desktop/AIRBNB_EUROPE"

for file in os.listdir(folder_path):
    if file.endswith(".xlsx"):
        file_path = os.path.join(folder_path, file)

        df = pd.read_excel(file_path)

        table_name = os.path.splitext(file)[0].lower()
        #import to SQL
        df.to_sql(name=table_name, con=engine, if_exists='replace', index=False)

print("ALl files have been imported!")
